I"W—<p>NetCDF4 ë°ì´í„°ë¥¼ ì½ì–´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ê°€ì‹œí™”í•´ë³´ê² ë‹¤.</p>

<p><img src="/assets/images/ts_uv_final.png" alt="ts_uv_final" /></p>

<p>ì‚¬ìš© ë°ì´í„°ëŠ” Hycom ì¬ë¶„ì„ ìë£Œì´ë©°, ê´€ë ¨ ë§í¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li><a href="https://www.hycom.org/">Hycom Homepage</a></li>
  <li><a href="ftp://ftp.hycom.org/datasets/GLBv0.08/expt_93.0/data/hindcasts/2020/">Hycom FTP</a></li>
</ul>

<p>íŒŒì¼ì˜ ë§ˆì§€ë§‰ì— ts3zë¼ ì í˜€ ìˆìœ¼ë©´ ìˆ˜ì˜¨ ë° ì—¼ë¶„ ë°ì´í„°, uv3zëŠ” ìœ ì† UV ë°ì´í„°ì´ë‹¤. ê·¸ë¦¬ê³  sshëŠ” ìˆ˜ìœ„ì´ë‹¤.<br />
ìš°ë¦¬ê°€ ê°€ì‹œí™”í•˜ê³ ì í•˜ëŠ” ë°ì´í„°ëŠ” ìˆ˜ì˜¨ê³¼ UVë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ì´ ë‘ê°€ì§€ë¥¼ ì €ì¥í•˜ì.<br />
ì‹œê°„ëŒ€ëŠ” ì•„ë¬´ê±°ë‚˜ ìƒê´€ì—†ë‹¤.</p>

<p><br /></p>

<h1 id="basemap-ì„¤ì¹˜">Basemap ì„¤ì¹˜</h1>
<p>Basemapì€ ì§€ë„ ë°ì´í„°ë¥¼ ë‹´ì€ íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.<br />
CMDì— ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.<br />
conda ëŒ€ì‹  pipë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">conda install -y -c conda-forge basemap geos proj4 basemap-data-hires
</span></code></pre></div></div>

<p><br /></p>

<h1 id="netcdf4-ì„¤ì¹˜">NetCDF4 ì„¤ì¹˜</h1>
<p>NetCDF4 íŒŒì¼ì„ ì½ê¸° ìœ„í•´ì„œëŠ” NetCDF4ë¥¼ ì½ì„ ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•˜ë‹¤.</p>

<p>ë§ˆì°¬ê°€ì§€ë¡œ ì„¤ì¹˜í•˜ë„ë¡ í•˜ì.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">conda install -c anaconda netcdf4
</span></code></pre></div></div>

<p><br /></p>

<h1 id="netcdf4-íŒŒì¼-ì½ê¸°">NetCDF4 íŒŒì¼ ì½ê¸°</h1>

<p>NetCDF4 ëª¨ë“ˆì˜ ì„¤ëª…ì„œëŠ” ë‹¤ìŒì˜ ë§í¬ì— ìˆë‹¤.</p>
<ul>
  <li><a href="https://unidata.github.io/netcdf4-python/netCDF4/index.html">NetCDF4 API documentation</a></li>
</ul>

<p>ìœ„ì˜ ë§í¬ë¥¼ ì°¸ì¡°í•˜ë©´ NetCDF4 íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ì½ê±°ë‚˜ ì“¸ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rootgrp</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"test.nc"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">rootgrp</span><span class="p">.</span><span class="n">data_model</span><span class="p">)</span>
<span class="n">NETCDF4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rootgrp</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>ìš°ë¦¬ëŠ” ë°ì´í„°ë¥¼ ì½ê³ ì í•˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">"w"</code>ê°€ ì•„ë‹Œ <code class="language-plaintext highlighter-rouge">"r"</code>ë¡œ ë°”ê¿”ì£¼ì.</p>

<p>ì´ í›„ í•œë²ˆ ì¶œë ¥í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì˜¨ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nc_data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"hycom_glbv_930_2019010112_t000_ts3z_r.nc"</span><span class="p">,</span>\
                      <span class="s">"r"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">nc_data</span><span class="p">)</span>

<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">netCDF4</span><span class="p">.</span><span class="n">_netCDF4</span><span class="p">.</span><span class="n">Dataset</span><span class="s">'&gt;
root group (NETCDF3_64BIT_OFFSET data model, file format NETCDF3):
    classification_level: UNCLASSIFIED
    distribution_statement: Approved for public release. Distribution unlimited.
    downgrade_date: not applicable
    classification_authority: not applicable
    institution: Naval Oceanographic Office
    source: HYCOM archive file
    history: Wed Sep 18 16:05:41 2019: ncks -d lon,115.,155. -d lat,18.,58. hycom_glbv_930_2019010112_t000_ts3z.nc hycom_glbv_930_2019010112_t000_ts3z_r.nc
archv2ncdf3z
    field_type: instantaneous
    Conventions: CF-1.6 NAVO_netcdf_v1.1
    NCO: 4.7.2
    dimensions(sizes): depth(40), lat(726), lon(500), time(1)
    variables(dimensions): float64 depth(depth), float64 lat(lat), float64 lon(lon), int16 salinity(time,depth,lat,lon), int16 salinity_bottom(time,lat,lon), float64 tau(time), float64 time(time), int16 water_temp(time,depth,lat,lon), int16 water_temp_bottom(time,lat,lon)
    groups: 

</span></code></pre></div></div>

<p>íŒŒì¼ì˜ ê¸°ë³¸ì ì¸ ì •ë³´(ë©”íƒ€ ë°ì´í„°)ê°€ ì „ë¶€ ë‚˜ì˜¤ëŠ”ë°, ì˜ˆë¥¼ ë“¤ë©´ ì°¨ì›ì€ <strong>ê¹Šì´, ìœ„ë„, ê²½ë„, ì‹œê°„</strong> ì´ 4ê°œì´ë©°, ê¹Šì´ëŠ” 40ê°œ, ìœ„ë„ëŠ” 726ê°œ, ê²½ë„ëŠ” 500ê°œ, ì‹œê°„ì€ 1ê°œê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë˜í•œ, ì´ íŒŒì¼ì´ ê°€ì§€ê³  ìˆëŠ” ë°ì´í„°ë¡œëŠ” <strong>ê¹Šì´, ìœ„ë„, ê²½ë„ ì´ì™¸ì—ë„ ì—¼ë¶„, í•´ì € ì—¼ë¶„, ì‹œê°„ ê°„ê²©, ì‹œê°„, ìˆ˜ì˜¨, í•´ì € ìˆ˜ì˜¨</strong>ì´ ìˆë‹¤.</p>

<p>ìš°ë¦¬ê°€ í•„ìš”í•œ ê²ƒì€ í•´ìˆ˜ë©´ ì˜¨ë„ì´ë¯€ë¡œ, depthë¥¼ í•œ ë²ˆ ì‚´í´ë³´ì</p>

<p>depthì˜ ë©”íƒ€ ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë³¼ ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">nc_data</span><span class="p">[</span><span class="s">'depth'</span><span class="p">])</span>
<span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">netCDF4</span><span class="p">.</span><span class="n">_netCDF4</span><span class="p">.</span><span class="n">Variable</span><span class="s">'&gt;
float64 depth(depth)
    long_name: Depth
    standard_name: depth
    units: m
    positive: down
    axis: Z
    NAVO_code: 5
unlimited dimensions: 
current shape = (40,)
filling on, default _FillValue of 9.969209968386869e+36 used
</span></code></pre></div></div>

<p>ë˜í•œ, ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë½‘ì•„ë³¼ ìˆ˜ ìˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">nc_data</span><span class="p">[</span><span class="s">'depth'</span><span class="p">][:])</span>
<span class="p">[</span><span class="mf">0.00e+00</span> <span class="mf">2.00e+00</span> <span class="mf">4.00e+00</span> <span class="mf">6.00e+00</span> <span class="mf">8.00e+00</span> <span class="mf">1.00e+01</span> <span class="mf">1.20e+01</span> <span class="mf">1.50e+01</span>
 <span class="mf">2.00e+01</span> <span class="mf">2.50e+01</span> <span class="mf">3.00e+01</span> <span class="mf">3.50e+01</span> <span class="mf">4.00e+01</span> <span class="mf">4.50e+01</span> <span class="mf">5.00e+01</span> <span class="mf">6.00e+01</span>
 <span class="mf">7.00e+01</span> <span class="mf">8.00e+01</span> <span class="mf">9.00e+01</span> <span class="mf">1.00e+02</span> <span class="mf">1.25e+02</span> <span class="mf">1.50e+02</span> <span class="mf">2.00e+02</span> <span class="mf">2.50e+02</span>
 <span class="mf">3.00e+02</span> <span class="mf">3.50e+02</span> <span class="mf">4.00e+02</span> <span class="mf">5.00e+02</span> <span class="mf">6.00e+02</span> <span class="mf">7.00e+02</span> <span class="mf">8.00e+02</span> <span class="mf">9.00e+02</span>
 <span class="mf">1.00e+03</span> <span class="mf">1.25e+03</span> <span class="mf">1.50e+03</span> <span class="mf">2.00e+03</span> <span class="mf">2.50e+03</span> <span class="mf">3.00e+03</span> <span class="mf">4.00e+03</span> <span class="mf">5.00e+03</span><span class="p">]</span>
</code></pre></div></div>
<p>í•´ìˆ˜ë©´ì€ 0ë²ˆì§¸ indexì— ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nc_data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"hycom_glbv_930_2019010112_t000_ts3z_r.nc"</span><span class="p">,</span>\
                  <span class="s">"r"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>
<span class="n">nc_data2</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"hycom_glbv_930_2019010112_t000_uv3z_r.nc"</span><span class="p">,</span>\
                  <span class="s">"r"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>

<span class="n">depth</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'depth'</span><span class="p">][:]</span>             <span class="c1">## ìˆ˜ì‹¬
</span><span class="n">lat</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'lat'</span><span class="p">][:]</span>                 <span class="c1">## ìœ„ë„
</span><span class="n">lon</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'lon'</span><span class="p">][:]</span>                 <span class="c1">## ê²½ë„
</span>
<span class="n">water_temp</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'water_temp'</span><span class="p">][:]</span>   <span class="c1">## ìˆ˜ì˜¨ ë°ì´í„°
</span><span class="n">sal</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'salinity'</span><span class="p">][:]</span>            <span class="c1">## ì—¼ë¶„ ë°ì´í„°
</span><span class="n">water_u</span> <span class="o">=</span> <span class="n">nc_data2</span><span class="p">[</span><span class="s">'water_u'</span><span class="p">][:]</span>        <span class="c1">## ìœ í–¥/ìœ ì† U
</span><span class="n">water_v</span> <span class="o">=</span> <span class="n">nc_data2</span><span class="p">[</span><span class="s">'water_v'</span><span class="p">][:]</span>        <span class="c1">## ìœ í–¥/ìœ ì† V
</span>
<span class="n">water_temp</span> <span class="o">=</span> <span class="n">water_temp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">water_u</span> <span class="o">=</span> <span class="n">water_u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">water_v</span> <span class="o">=</span> <span class="n">water_v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="ìˆ˜ì˜¨-ê°€ì‹œí™”">ìˆ˜ì˜¨ ê°€ì‹œí™”</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'w'</span><span class="p">)</span>

<span class="c1"># ìˆ˜ì˜¨ Contourf
</span><span class="n">water_temp_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">water_temp</span><span class="p">,</span>\
                              <span class="n">levels</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'jet'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">water_temp_plot</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="/assets/images/water_temp.png" alt="water_temp" /></p>

<p><br /></p>

<h1 id="ìœ ì†-ìœ í–¥-ê°€ì‹œí™”">ìœ ì†, ìœ í–¥ ê°€ì‹œí™”</h1>

<p>ì—¬ê¸°ì— UVë¥¼ ì¶”ê°€í•´ì£¼ì</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span><span class="p">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">water_u</span><span class="p">,</span> <span class="n">water_v</span><span class="p">,</span>\
          <span class="n">pivot</span><span class="o">=</span><span class="s">'mid'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>ë‹¤ë§Œ ì´ë ‡ê²Œ í•˜ë©´ quiverê°€ ë„ˆë¬´ ë§ì•„ì„œ ê·¸ë¦¼ì´ ì§€ì €ë¶„í•´ì§€ë¯€ë¡œ stepì„ ì£¼ì</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ax</span><span class="p">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span>
           <span class="n">water_u</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span> <span class="n">water_v</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span>
           <span class="n">pivot</span><span class="o">=</span><span class="s">'mid'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ts_uv.png" alt="ts_uv" /></p>

<p>ê½¤ë‚˜ ì´ì˜ê²Œ ë³´ì¸ë‹¤.</p>

<p><br /></p>

<h1 id="ì§€ë„-ì¶”ê°€">ì§€ë„ ì¶”ê°€</h1>

<p>ì´ì œ ì—¬ê¸°ì— ì§€ë„ë¥¼ ì¶”ê°€í•´ì¤„ ê²ƒì´ë‹¤.<br />
ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'cyl'</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span>\
            <span class="n">llcrnrlon</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">'l'</span><span class="p">)</span>
<span class="n">m</span><span class="p">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">'lightgray'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/images/ts_uv_land.png" alt="ts_uv_land" /></p>

<p><br /></p>

<h1 id="ê°•ì´ë‚˜-í˜¸ìˆ˜-ì œê±°">ê°•ì´ë‚˜ í˜¸ìˆ˜ ì œê±°</h1>

<p>ê·¸ëŸ°ë° ëŸ¬ì‹œì•„ìª½ì— ê°•ì´ë‚˜ í˜¸ìˆ˜ê°€ ë³´ì´ëŠ”ë°, ì´ê²Œ ê½¤ë‚˜ ê±°ìŠ¬ë¦°ë‹¤.
ì–´ë–»ê²Œ í•˜ë©´ ì§€ìš¸ ìˆ˜ ìˆì„ê¹Œ í•˜ë‹¤ ë‹¤ìŒê³¼ ê°™ì€ ê¸€ì„ ë³´ì•˜ë‹¤.</p>

<blockquote>
  <p>If you want to stick with Basemap, get a shapefile which doesnt contain the rivers. Natural Earth for example has a nice â€˜Landâ€™ shapefile in the physical section (download â€˜scale rankâ€™ data and uncompress). See <a href="http://www.naturalearthdata.com/downloads/10m-physical-vectors/">http://www.naturalearthdata.com/downloads/10m-physical-vectors/</a></p>

  <p>(ë§í¬ <a href="https://stackoverflow.com/questions/14280312/world-map-without-rivers-with-matplotlib-basemap">https://stackoverflow.com/questions/14280312/world-map-without-rivers-with-matplotlib-basemap</a>)</p>
</blockquote>

<p>ìš”ì•½í•˜ìë©´, Basemapì€ ì“°ê³  ì‹¶ì€ë° ê°•ì€ ë³´ê¸° ì‹«ìœ¼ë©´ ìœ„ì˜ ë§í¬ë¡œ ë“¤ì–´ê°€ â€˜Landâ€™ shapefileì„ ë‹¤ìš´ë°›ìœ¼ë¼ê³  í•œë‹¤. ìœ„ì˜ ë§í¬ì— ë“¤ì–´ê°€ë©´ Landê°€ ë³´ì´ëŠ”ë°, ìœ„ì˜ ê¸€ ì²˜ëŸ¼ <strong>scale rank</strong>ë¥¼ ë‹¤ìš´ë°›ì§€ ë§ê³  <strong>land</strong>ë¥¼ ë‹¤ìš´ë°›ë„ë¡ í•˜ì. ë‹¤ìš´ë°›ì•˜ìœ¼ë©´ ì½”ë“œ ìœ„ì¹˜ì— ë„£ê³ , ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PathCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">shp_info</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">readshapefile</span><span class="p">(</span><span class="s">'10m/ne_10m_land'</span><span class="p">,</span> <span class="s">'scalerank'</span><span class="p">)</span>

<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">shp_info</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">_paths</span><span class="p">:</span>
    <span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="o">=</span><span class="n">line</span><span class="p">.</span><span class="n">codes</span><span class="p">))</span>
<span class="n">coll</span> <span class="o">=</span> <span class="n">PathCollection</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> \
                     <span class="n">facecolors</span><span class="o">=</span><span class="s">'lightgrey'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="p">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">shp_info = m.readshapefile('10m/ne_10m_land', 'scalerank')</code>ì˜ íŒŒì¼ ê²½ë¡œë¶€ë¶„ì— ìì‹ ì´ ë‹¤ìš´ë¡œë“œí•œ 10m land ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ ì ìœ¼ë©´ ë˜ê² ë‹¤.</p>

<p>ìœ„ì˜ ì½”ë“œë¥¼ í•œ ê³³ì— ëª¨ì•„ë‘ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë¬¼ì´ ë‚˜ì˜¨ë‹¤.</p>

<p><img src="/assets/images/ts_uv_no_interp.png" alt="ts_uv_no_interp" /></p>

<p><br /></p>

<h1 id="ë‚´ì‚½-ë°-ì™¸ì‚½interpolation--extrapolation">ë‚´ì‚½ ë° ì™¸ì‚½(Interpolation &amp; Extrapolation)</h1>

<p>ì‚¬ìš©í•œ NetCDF4 ë°ì´í„°ê°€ Basemapì˜ ìœ¡ì§€ ë°ì´í„°ì™€ ì™„ë²½í•˜ê²Œ ë§ì•„ë–¨ì–´ì§€ì§€ ì•Šì•„ì„œ ì¤‘ê°„ì¤‘ê°„ì— í°ìƒ‰ ë¹ˆ ì¹¸ì´ ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.<br />
ì´ë¥¼ ì§€ìš°ê³ ì í•œë‹¤ë©´ ë‚´ì‚½(Intrapolation)ê³¼ ì™¸ì‚½(Extrapolation)ì„ í•´ì¤˜ì•¼ í• í…ë°, ë‚´ì‚½ê³¼ ì™¸ì‚½ì´ í•„ìš”í•œ ì˜ì—­ì´ ì›Œë‚™ ì‘ê³  ë°”ë¡œ ì˜†ì˜ ê°’ì€ í¬ê²Œ ì°¨ì´ë‚˜ì§€ ì•Šì„í…Œë‹ˆê¹Œ <strong>nearest neighbor</strong>ë°©ë²•ì„ ì‚¬ìš©í•˜ê² ë‹¤.\</p>

<p><code class="language-plaintext highlighter-rouge">Pandas</code>ë¼ëŠ” ëª¨ë“ˆì— ë‚´ì‚½ê³¼ ì™¸ì‚½ì„ í•´ì£¼ëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤.<br />
ì´í›„ <code class="language-plaintext highlighter-rouge">Pandas</code>ì— ëŒ€í•´ ìì„¸íˆ ë‹¤ë£¨ê² ë‹¤ë§Œ, <code class="language-plaintext highlighter-rouge">Pandas</code>ëŠ” ì˜¤í”ˆì†ŒìŠ¤ ë°ì´í„° ë¶„ì„ ë° ì¡°ì‘ ë„êµ¬ì´ë‹¤.<br />
ë°ì´í„°ë² ì´ìŠ¤ ìƒì— ê°’ì´ ì—†ëŠ” ì¼ì€ í”í•˜ë©°, ì´ë¥¼ ì±„ìš°ê¸° ìœ„í•´ fillnaë¼ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤.<br />
ìˆ˜ì˜¨ ë°ì´í„°ë¥¼ ê°€ì‹œí™” í•˜ê¸° ì „ì— ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•´ì£¼ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Interpolation &amp; Extrapolation
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">water_temp</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'bfill'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">water_temp</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<p>ìœ„ì˜ ì½”ë“œëŠ” water_tempë¥¼ í‘œ í˜•ì‹ì˜ ë°ì´í„°ë² ì´ìŠ¤(pd.DataFrame)ìœ¼ë¡œ ë°”ê¿”ì£¼ê³ , ê° ì—´ë³„ë¡œ ë¹ˆ ê°’ì„ ì±„ì›Œì¤€ë‹¤.<br />
<strong>ffill</strong>ì€ ë°ì´í„°ê°€ ì—†ì„ ë•Œ ì•ì— ë‚˜ì˜¨ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ê³ , <strong>bfill</strong>ì€ ë°ì´í„°ê°€ ì—†ì„ ë•Œ ë’¤ì— ë‚˜ì˜¨ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ëŠ”ë‹¤.</p>

<p>ì´í›„ì— water_tempë§Œì„ ì¶œë ¥í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë¹ˆ ì¹¸ì´ ë§¤ì›Œì§„ ê·¸ë¦¼ì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="/assets/images/extrapolation.png" alt="extrapolation" /></p>

<p><br /></p>

<h1 id="ì „ì²´-ì½”ë“œ">ì „ì²´ ì½”ë“œ</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">nc_data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"hycom_glbv_930_2019010112_t000_ts3z_r.nc"</span><span class="p">,</span>\
                  <span class="s">"r"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>
<span class="n">nc_data2</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s">"hycom_glbv_930_2019010112_t000_uv3z_r.nc"</span><span class="p">,</span>\
                  <span class="s">"r"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"NETCDF4"</span><span class="p">)</span>
 
<span class="n">depth</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'depth'</span><span class="p">][:]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'lon'</span><span class="p">][:]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'lat'</span><span class="p">][:]</span>

<span class="n">water_temp</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'water_temp'</span><span class="p">][:]</span>
<span class="n">sal</span> <span class="o">=</span> <span class="n">nc_data</span><span class="p">[</span><span class="s">'salinity'</span><span class="p">][:]</span>
<span class="n">water_u</span> <span class="o">=</span> <span class="n">nc_data2</span><span class="p">[</span><span class="s">'water_u'</span><span class="p">][:]</span>
<span class="n">water_v</span> <span class="o">=</span> <span class="n">nc_data2</span><span class="p">[</span><span class="s">'water_v'</span><span class="p">][:]</span>

<span class="n">water_temp</span> <span class="o">=</span> <span class="n">water_temp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">water_u</span> <span class="o">=</span> <span class="n">water_u</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">water_v</span> <span class="o">=</span> <span class="n">water_v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s">'w'</span><span class="p">)</span>

<span class="c1">## ì™¸ì‚½ ë° ë‚´ì‚½
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">water_temp</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'bfill'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">water_temp</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">values</span>

<span class="c1"># ìˆ˜ì˜¨ ê°€ì‹œí™”
</span><span class="n">water_temp_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">water_temp</span><span class="p">,</span>\
                             <span class="n">levels</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'jet'</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">water_temp_plot</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span>
            <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>

<span class="c1"># ìœ ì† ê°€ì‹œí™”
</span><span class="n">step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ax</span><span class="p">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">lon</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span> <span class="n">lat</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span>
           <span class="n">water_u</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span> <span class="n">water_v</span><span class="p">[::</span><span class="n">step</span><span class="p">,::</span><span class="n">step</span><span class="p">],</span>
           <span class="n">pivot</span><span class="o">=</span><span class="s">'mid'</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># Basemapì„ ì‚¬ìš©í•œ ì§€ë„
</span><span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'cyl'</span><span class="p">,</span><span class="n">llcrnrlat</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">urcrnrlat</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span>\
            <span class="n">llcrnrlon</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span><span class="n">urcrnrlon</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s">'l'</span><span class="p">)</span>
<span class="n">m</span><span class="p">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
<span class="n">m</span><span class="p">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">'lightgray'</span><span class="p">,</span><span class="n">lake_color</span><span class="o">=</span><span class="s">'aqua'</span><span class="p">)</span>

<span class="c1"># ê°•, í˜¸ìˆ˜ ì—†ì• ê¸°
</span><span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PathCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">shp_info</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">readshapefile</span><span class="p">(</span><span class="s">'10m/ne_10m_land'</span><span class="p">,</span> <span class="s">'scalerank'</span><span class="p">)</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">shp_info</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">_paths</span><span class="p">:</span>
    <span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="o">=</span><span class="n">line</span><span class="p">.</span><span class="n">codes</span><span class="p">))</span>
<span class="n">coll</span> <span class="o">=</span> <span class="n">PathCollection</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>\
                      <span class="n">facecolors</span><span class="o">=</span><span class="s">'lightgrey'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>

<span class="c1"># ì œëª©, ë¼ë²¨, í‹± ë“± ì„¤ì •
</span><span class="n">ax</span><span class="p">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Longitude'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Latitude'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Water Temperature and UV (2019.01.01 12:00)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ts_uv_final.png" alt="ts_uv_final" /></p>
:ET